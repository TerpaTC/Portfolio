const scrollToTopBtn = document.getElementById("scrollToTopBtn"), fireworkCanvas = document.getElementById("fireworkCanvas"), fireworkCtx = fireworkCanvas.getContext("2d"); let particles = [], explosionCenter = { x: 0, y: 0 }, suckingStarted = !1, explosionRunning = !1; function resizeFireworkCanvas() { fireworkCanvas.width = window.innerWidth, fireworkCanvas.height = window.innerHeight } function createParticles(e, o) { particles = []; for (let r = 0; r < 80; r++)particles.push({ x: e, y: o, angle: Math.random() * Math.PI * 2, speed: 5 * Math.random() + 3, radius: 2 * Math.random() + 1, color: `hsl(${360 * Math.random()}, 100%, 70%)`, alpha: 1, spiral: 0 }) } function updateParticles() { fireworkCtx.clearRect(0, 0, fireworkCanvas.width, fireworkCanvas.height), particles.forEach((e, o) => { if (suckingStarted) { let r = explosionCenter.x - e.x, t = explosionCenter.y - e.y, n = Math.min(.08, 5 / (Math.sqrt(r * r + t * t) || 1)); e.spiral += .3, e.x += n * r + 2 * Math.cos(e.spiral), e.y += n * t + 2 * Math.sin(e.spiral) } else e.x += Math.cos(e.angle) * e.speed, e.y += Math.sin(e.angle) * e.speed, e.speed *= .96; e.alpha *= .97, fireworkCtx.beginPath(), fireworkCtx.arc(e.x, e.y, e.radius, 0, 2 * Math.PI), fireworkCtx.fillStyle = `rgba(${hslToRgb(e.color)}, ${e.alpha})`, fireworkCtx.fill(), e.alpha < .05 && particles.splice(o, 1) }), particles.length > 0 ? requestAnimationFrame(updateParticles) : explosionRunning = !1 } function hslToRgb(e) { let o = document.createElement("div"); o.style.color = e, document.body.appendChild(o); let r = getComputedStyle(o).color.match(/\d+/g).join(","); return document.body.removeChild(o), r } resizeFireworkCanvas(), window.addEventListener("resize", resizeFireworkCanvas), window.addEventListener("scroll", () => { !explosionRunning && window.scrollY > 100 ? scrollToTopBtn.classList.add("show") : explosionRunning || scrollToTopBtn.classList.remove("show") }), scrollToTopBtn.addEventListener("click", e => { e.preventDefault(), playFireworkSound(), explosionRunning = !0, scrollToTopBtn.classList.remove("show"), scrollToTopBtn.style.animation = "explodeButton 1s forwards"; let o = scrollToTopBtn.getBoundingClientRect(), r = o.left + o.width / 2, t = o.top + o.height / 2; explosionCenter = { x: r, y: t }, createParticles(r, t), suckingStarted = !1, updateParticles(), setTimeout(() => { suckingStarted = !0 }, 500), setTimeout(() => { window.scrollTo({ top: 0, behavior: "smooth" }), scrollToTopBtn.style.animation = "", explosionRunning = !1 }, 1e3) });